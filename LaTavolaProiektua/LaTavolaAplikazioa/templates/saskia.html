{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <h1 class="mb-4">Saskia</h1>
            <div id="cartItems" class="cart-items">
                <!-- Aquí se mostrarán los productos del carrito -->
            </div>
            <hr>
            <div class="total">
                <h4>Guztira</h4>
                <p id="totalPrice" class="total-price">0.00€</p>
            </div>
            <button class="btn btn-danger btn-lg mt-3" onclick="comprar()">EROSI</button>
        </div>

        <div class="col-md-4">
            <h2>Gomendatutako Platerrak</h2>
            <div class="recommended-item mb-3 d-flex flex-md-row flex-column align-items-center">
                <div class="recommended-img-container mb-2 mb-md-0">
                    <img src="{% static 'img/pasta.png' %}" class="img-fluid recommended-img" alt="Carbonara Pasta">
                </div>
                <div class="recommended-text">
                    <h4>Carbonara Pasta</h4>
                    <p>Pasta goxoan arrautza, gazta eta hungihar saltsa krematsuarekin.</p>
                    <button class="btn btn-danger" onclick="addToCart('Carbonara Pasta', 15.99)">Eskatu</button>
                </div>
            </div>
            <div class="recommended-item d-flex flex-md-row flex-column align-items-center">
                <div class="recommended-img-container mb-2 mb-md-0">
                    <img src="{% static 'img/pizza.png' %}" class="img-fluid recommended-img" alt="Margarita Pizza">
                </div>
                <div class="recommended-text">
                    <h4>Margarita Pizza</h4>
                    <p>Italiar pizza klasikoa tomate, mozzarella eta albahakarekin.</p>
                    <button class="btn btn-danger" onclick="addToCart('Margarita Pizza', 16.30)">Eskatu</button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .container {
        margin-top: 20px;
        margin-bottom: 20px;
    }
    .cart-items p, .total {
        display: flex;
        justify-content: space-between;
        font-size: 1.2rem;
    }
    .price, .total-price {
        font-weight: bold;
    }
    .recommended-item {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 15px;
        width: 100%;
    }
    .recommended-img-container {
        width: 100%;
        max-width: 100px; /* Controla el ancho máximo de la imagen */
    }
    .recommended-img {
        width: 100%;
        height: auto;
        border-radius: 5px;
    }
    .recommended-text {
        text-align: center;
    }
    .btn-danger {
        background-color: #d9534f;
        border: none;
    }
</style>

<script>
function addToCart(productName, productPrice) {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const existingProductIndex = cart.findIndex(item => item.name === productName);

    if (existingProductIndex > -1) {
        cart[existingProductIndex].quantity += 1;
    } else {
        cart.push({ name: productName, price: productPrice, quantity: 1 });
    }

    localStorage.setItem("cart", JSON.stringify(cart));
    alert("Producto añadido al carrito");
}

function displayCartItems() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartItemsContainer = document.getElementById("cartItems");
    const totalPriceElement = document.getElementById("totalPrice");

    cartItemsContainer.innerHTML = "";
    let total = 0;

    cart.forEach(item => {
        const itemElement = document.createElement("p");
        itemElement.innerHTML = `${item.quantity}x ${item.name} <span class="price">${(item.price * item.quantity).toFixed(2)}€</span>`;
        cartItemsContainer.appendChild(itemElement);
        total += item.price * item.quantity;
    });

    totalPriceElement.innerHTML = `${total.toFixed(2)}€`;
}

function comprar() {
    alert("Gracias por tu compra!");
    localStorage.removeItem("cart");
    displayCartItems();
}

document.addEventListener("DOMContentLoaded", displayCartItems);
</script>
{% endblock %}
